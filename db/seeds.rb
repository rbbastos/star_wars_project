# frozen_string_literal: true

Character.destroy_all
Inhabit.destroy_all
Specie.destroy_all
Planet.destroy_all
Starship.destroy_all
Page.destroy_all

csv_file_characters = Rails.root + 'db/characters.csv'
options = { file_encoding: 'iso-8859-1' } # Only needed if the CSV file was generated by Excel.
charactersCSV = SmarterCSV.process(csv_file_characters, options) # Pass the "options" hash as a second argument if CSV was created by Excel.

csv_file_planets = Rails.root + 'db/planets.csv'
options = { file_encoding: 'iso-8859-1' } # Only needed if the CSV file was generated by Excel.
planetsCSV = SmarterCSV.process(csv_file_planets, options) # Pass the "options" hash as a second argument if CSV was created by Excel.

csv_file_species = Rails.root + 'db/species.csv'
options = { file_encoding: 'iso-8859-1' } # Only needed if the CSV file was generated by Excel.
speciesCSV = SmarterCSV.process(csv_file_species, options) # Pass the "options" hash as a second argument if CSV was created by Excel.

csv_file_starships = Rails.root + 'db/starships.csv'
options = { file_encoding: 'iso-8859-1' } # Only needed if the CSV file was generated by Excel.
starshipsCSV = SmarterCSV.process(csv_file_starships, options) # Pass the "options" hash as a second argument if CSV was created by Excel.

planetsCount = planetsCSV.count
charactersCount = charactersCSV.count
speciesCount = speciesCSV.count
starshipsCount = starshipsCSV.count
f = planetsCSV.first
puts f[:name]
puts f[:population]
puts planetsCount
puts charactersCount
puts speciesCount
puts starshipsCount

# create Starships
# starship = Starship.new
starship = Starship.new
planet = Planet.new
specie = Specie.new

rand(10..starshipsCount).times do
  name = starshipsCSV[rand(starshipsCSV.length)]
  # name and model presence: true
  starship = Starship.create(
    name: name[:name],
    model: name[:model],
    crew: name[:crew]
  )

  # rand(21..planetsCount).times do
  name = planetsCSV[rand(planetsCSV.length)]
  # name and model presence: true
  planet = Planet.create(
    name: Faker::Movies::StarWars.planet,
    population: name[:population]
  )
  # end

  # rand(15..speciesCount).times do
  name = speciesCSV[rand(speciesCSV.length)]
  # name and model presence: true
  specie = Specie.create(
    name: name[:name],
    language: name[:language]
  )
  # end

  rand(50..100).times do
    name = charactersCSV[rand(charactersCSV.length)]
    Character.create(
      name: name[:name],
      starship_id: starship.id,
      planet_id: planet.id,
      specie_id: specie.id
    )
    # name: name[:name]
    # puts character.name
  end
end

rand(100..200).times do
  s = Specie.order('random()').first.id
  p = Planet.order('random()').first.id
  # puts s.specie_id
  # puts p.planet_id
  Inhabit.create(
    planet_id: p,
    specie_id: s
  )
end

Page.create(title: 'About Us', content: 'Please fill this in.', permalink: 'about_us')

puts "Generated #{Starship.count} starships."
puts "Generated #{Planet.count} planets."
puts "Generated #{Specie.count} species."
puts "Generated #{Character.count} characters."
puts "Generated #{Inhabit.count} inhabits."
